"use strict";exports.id=851,exports.ids=[851],exports.modules={60367:(a,b,c)=>{c.d(b,{A:()=>q});var d=c(60687),e=c(43210),f=c(45667),g=c(89114),h=c(66524),i=c(91164),j=c(6854),k=c(26403),l=c(65443),m=c(79819),n=c(81836),o=c(14689);function p({isOpen:a,onClose:b,fileId:c,fileName:f}){let[g,h]=(0,e.useState)([]),[i,j]=(0,e.useState)(""),[k,l]=(0,e.useState)("VIEW"),[m,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(!1),[s,t]=(0,e.useState)(""),u=async()=>{if(!i)return void t("Please select a user to share with");r(!0),t("");try{let a=await fetch(`/api/files/${c}/share`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sharedWith:i,permissions:k,expiresAt:m||null})});if(a.ok)t("File shared successfully!"),setTimeout(()=>{b(),t(""),j(""),l("VIEW"),p("")},1500);else{let b=await a.json();t(b.error||"Failed to share file")}}catch(a){console.error("Error sharing file:",a),t("Failed to share file")}finally{r(!1)}};return a?(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,d.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Share File"}),(0,d.jsx)("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",children:(0,d.jsx)(n.A,{className:"h-5 w-5"})})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{children:(0,d.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Sharing: ",(0,d.jsx)("span",{className:"font-medium",children:f})]})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Share with user"}),(0,d.jsxs)("select",{value:i,onChange:a=>j(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"",children:"Select a user..."}),g.map(a=>(0,d.jsxs)("option",{value:a.id,children:[a.name," (",a.email,")",a.isExternal&&" - External"]},a.id))]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permission level"}),(0,d.jsxs)("select",{value:k,onChange:a=>l(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"VIEW",children:"View only"}),(0,d.jsx)("option",{value:"DOWNLOAD",children:"View and download"}),(0,d.jsx)("option",{value:"EDIT",children:"Full access (view, download, edit)"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expires on (optional)"}),(0,d.jsx)("input",{type:"datetime-local",value:m,onChange:a=>p(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().slice(0,16)})]}),s&&(0,d.jsxs)("div",{className:`p-3 rounded-md text-sm ${s.includes("successfully")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[s.includes("successfully")&&(0,d.jsx)(o.A,{className:"h-4 w-4 inline mr-1"}),s]}),(0,d.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,d.jsx)("button",{onClick:u,disabled:q||!i,className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:q?"Sharing...":"Share File"}),(0,d.jsx)("button",{onClick:b,className:"flex-1 bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300",children:"Cancel"})]})]})]})}):null}function q({parentId:a,onFolderClick:b,refreshTrigger:c}){let[n,o]=(0,e.useState)([]),[q,r]=(0,e.useState)(!0),[s,t]=(0,e.useState)(null),[u,v]=(0,e.useState)(null),[w,x]=(0,e.useState)("list"),y=a=>{if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["Bytes","KB","MB","GB"][b]},z=a=>{window.open(`/api/files/${a}/view`,"_blank")},A=(a,b)=>{let c=document.createElement("a");c.href=`/api/files/${a}/download`,c.download=b,document.body.appendChild(c),c.click(),document.body.removeChild(c)},B=(a,b)=>{v({fileId:a,fileName:b})},C=async b=>{try{let c=await fetch(`/api/files/${b}/delete`,{method:"POST"});if(c.ok){let b=a?`/api/files?parentId=${a}`:"/api/files",c=await fetch(b);if(c.ok){let a=await c.json();o(a.files||[])}t(null)}else{let a=await c.json();alert(`Error: ${a.error}`)}}catch(a){console.error("Error deleting file:",a),alert("Failed to delete file")}},D=a=>{t(a)};return q?(0,d.jsxs)("div",{className:"p-6 text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,d.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading files..."})]}):0===n.length?(0,d.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-12 text-center",children:[(0,d.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl flex items-center justify-center mx-auto mb-6",children:(0,d.jsx)(f.A,{className:"h-10 w-10 text-gray-400"})}),(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No files or folders yet"}),(0,d.jsx)("p",{className:"text-gray-500",children:"Upload some files to get started"})]}):(0,d.jsxs)(d.Fragment,{children:[u&&(0,d.jsx)(p,{isOpen:!0,onClose:()=>{v(null)},fileId:u.fileId,fileName:u.fileName}),s&&(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,d.jsx)("div",{className:"relative top-20 mx-auto p-6 border w-96 shadow-lg rounded-2xl bg-white",children:(0,d.jsxs)("div",{className:"mt-3 text-center",children:[(0,d.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-2xl bg-gradient-to-br from-red-500 to-red-600 shadow-lg",children:(0,d.jsx)(k.A,{className:"h-8 w-8 text-white"})}),(0,d.jsx)("h3",{className:"text-xl font-bold text-gray-900 mt-4",children:"Delete File"}),(0,d.jsx)("div",{className:"mt-3 px-4 py-3",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this file? This action cannot be undone."})}),(0,d.jsxs)("div",{className:"flex justify-center space-x-4 mt-6",children:[(0,d.jsx)("button",{onClick:()=>C(s),className:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white text-sm font-semibold rounded-xl hover:from-red-600 hover:to-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 shadow-lg transform hover:scale-105",children:"Delete"}),(0,d.jsx)("button",{onClick:()=>{t(null)},className:"px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white text-sm font-semibold rounded-xl hover:from-gray-600 hover:to-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 shadow-lg transform hover:scale-105",children:"Cancel"})]})]})})}),(0,d.jsxs)("div",{className:"bg-white shadow-lg rounded-2xl border border-gray-200 overflow-hidden",children:[(0,d.jsx)("div",{className:"px-8 py-6 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-gray-100",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Browse and manage your files"}),(0,d.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"View, organize, and share your documents"})]}),(0,d.jsxs)("div",{className:"flex bg-white rounded-xl shadow-sm border border-gray-200 p-1",children:[(0,d.jsxs)("button",{onClick:()=>x("list"),className:`flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${"list"===w?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[(0,d.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"List"]}),(0,d.jsxs)("button",{onClick:()=>x("grid"),className:`flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${"grid"===w?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[(0,d.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Grid"]})]})]})}),"grid"===w?(0,d.jsx)(()=>(0,d.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 p-6",children:n.map(a=>(0,d.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 hover:border-gray-300 hover:shadow-lg transition-all duration-200 p-4 group",children:(0,d.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,d.jsx)("div",{className:"w-12 h-12 mb-3 flex items-center justify-center",children:a.isFolder?(0,d.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,d.jsx)(f.A,{className:"h-6 w-6 text-white"})}):(0,d.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-400 to-gray-500 rounded-xl flex items-center justify-center shadow-lg",children:(0,d.jsx)(g.A,{className:"h-6 w-6 text-white"})})}),(0,d.jsx)("button",{onClick:()=>a.isFolder&&b?.(a.id),className:`text-sm font-medium truncate w-full ${a.isFolder?"text-blue-600 hover:text-blue-800 cursor-pointer hover:underline":"text-gray-900"}`,title:a.originalName,children:a.originalName}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:a.isFolder?"Folder":y(a.size)}),(0,d.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 mt-3 flex space-x-1",children:[!a.isFolder&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:()=>z(a.id),className:"p-1.5 rounded-lg text-gray-400 hover:text-blue-600 hover:bg-blue-50 transition-colors",title:"View file",children:(0,d.jsx)(h.A,{className:"h-4 w-4"})}),(0,d.jsx)("button",{onClick:()=>A(a.id,a.originalName),className:"p-1.5 rounded-lg text-gray-400 hover:text-green-600 hover:bg-green-50 transition-colors",title:"Download file",children:(0,d.jsx)(i.A,{className:"h-4 w-4"})})]}),(0,d.jsx)("button",{onClick:()=>B(a.id,a.originalName),className:"p-1.5 rounded-lg text-gray-400 hover:text-purple-600 hover:bg-purple-50 transition-colors",title:"Share",children:(0,d.jsx)(j.A,{className:"h-4 w-4"})}),(0,d.jsx)("button",{onClick:()=>D(a.id),className:"p-1.5 rounded-lg text-gray-400 hover:text-red-600 hover:bg-red-50 transition-colors",title:"Delete",children:(0,d.jsx)(k.A,{className:"h-4 w-4"})})]})]})},a.id))}),{}):(0,d.jsx)(()=>(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,d.jsx)("thead",{className:"bg-gray-50",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Name"}),(0,d.jsx)("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Size"}),(0,d.jsx)("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Modified"}),(0,d.jsx)("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Owner"}),(0,d.jsx)("th",{className:"px-8 py-4 text-right text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,d.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(a=>(0,d.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[(0,d.jsx)("td",{className:"px-8 py-6 whitespace-nowrap",children:(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[a.isFolder?(0,d.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,d.jsx)(f.A,{className:"h-5 w-5 text-white"})}):(0,d.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-gray-400 to-gray-500 rounded-xl flex items-center justify-center shadow-lg",children:(0,d.jsx)(g.A,{className:"h-5 w-5 text-white"})}),(0,d.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,d.jsx)("button",{onClick:()=>a.isFolder&&b?.(a.id),className:`text-sm font-semibold truncate block ${a.isFolder?"text-blue-600 hover:text-blue-800 cursor-pointer hover:underline":"text-gray-900"}`,children:a.originalName}),(0,d.jsx)("p",{className:"text-xs text-gray-500 truncate mt-1",children:a.mimeType})]})]})}),(0,d.jsx)("td",{className:"px-8 py-6 whitespace-nowrap text-sm font-medium text-gray-900",children:a.isFolder?(0,d.jsx)("span",{className:"text-gray-400",children:"—"}):y(a.size)}),(0,d.jsx)("td",{className:"px-8 py-6 whitespace-nowrap text-sm text-gray-500 font-medium",children:new Date(a.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,d.jsx)("td",{className:"px-8 py-6 whitespace-nowrap text-sm text-gray-500",children:(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg",children:(0,d.jsx)("span",{className:"text-xs font-semibold text-white",children:a.owner.name.charAt(0).toUpperCase()})}),(0,d.jsx)("span",{className:"truncate font-medium",children:a.owner.name})]})}),(0,d.jsx)("td",{className:"px-8 py-6 whitespace-nowrap text-sm text-gray-500",children:(0,d.jsxs)("div",{className:"flex justify-end space-x-2",children:[!a.isFolder&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:()=>z(a.id),className:"inline-flex items-center p-2 border border-transparent rounded-xl text-gray-400 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200",title:"View file",children:(0,d.jsx)(h.A,{className:"h-4 w-4"})}),(0,d.jsx)("button",{onClick:()=>A(a.id,a.originalName),className:"inline-flex items-center p-2 border border-transparent rounded-xl text-gray-400 hover:text-green-600 hover:bg-green-50 transition-all duration-200",title:"Download file",children:(0,d.jsx)(i.A,{className:"h-4 w-4"})})]}),(0,d.jsx)("button",{onClick:()=>B(a.id,a.originalName),className:"inline-flex items-center p-2 border border-transparent rounded-xl text-gray-400 hover:text-purple-600 hover:bg-purple-50 transition-all duration-200",title:"Share",children:(0,d.jsx)(j.A,{className:"h-4 w-4"})}),(0,d.jsx)("button",{onClick:()=>D(a.id),className:"inline-flex items-center p-2 border border-transparent rounded-xl text-gray-400 hover:text-red-600 hover:bg-red-50 transition-all duration-200",title:"Delete",children:(0,d.jsx)(k.A,{className:"h-4 w-4"})})]})})]},a.id))})]})}),{})]})]})}},83849:(a,b,c)=>{c.d(b,{A:()=>h});var d=c(60687),e=c(43210),f=c(51934),g=c(89944);function h({parentId:a,onUploadSuccess:b}){let[c,h]=(0,e.useState)(!1),[i,j]=(0,e.useState)({}),k=(0,e.useCallback)(async c=>{for(let b of(h(!0),c)){let c=new FormData;c.append("file",b),a&&c.append("parentId",a);try{j(a=>({...a,[b.name]:0})),(await fetch("/api/files/upload",{method:"POST",body:c})).ok?(j(a=>({...a,[b.name]:100})),setTimeout(()=>{j(a=>{let c={...a};return delete c[b.name],c})},2e3)):console.error("Upload failed for",b.name)}catch(a){console.error("Upload error:",a)}}h(!1),b?.()},[a,b]),{getRootProps:l,getInputProps:m,isDragActive:n}=(0,f.VB)({onDrop:k,multiple:!0,maxSize:0x6400000});return(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{...l(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${n?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[(0,d.jsx)("input",{...m()}),(0,d.jsx)(g.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n?(0,d.jsx)("p",{className:"text-blue-600",children:"Drop the files here..."}):(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-gray-600 mb-2",children:"Drag & drop files here, or click to select files"}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Maximum file size: 100MB"})]})]}),Object.keys(i).length>0&&(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("h4",{className:"font-medium text-gray-900",children:"Uploading Files"}),Object.entries(i).map(([a,b])=>(0,d.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,d.jsx)("span",{className:"truncate",children:a}),(0,d.jsxs)("span",{children:[b,"%"]})]}),(0,d.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${b}%`}})})]},a))]})]})}}};
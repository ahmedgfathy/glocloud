exports.id=646,exports.ids=[646],exports.modules={9607:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,16133,23)),Promise.resolve().then(c.t.bind(c,16444,23)),Promise.resolve().then(c.t.bind(c,16042,23)),Promise.resolve().then(c.t.bind(c,49477,23)),Promise.resolve().then(c.t.bind(c,29345,23)),Promise.resolve().then(c.t.bind(c,12089,23)),Promise.resolve().then(c.t.bind(c,46577,23)),Promise.resolve().then(c.t.bind(c,31307,23)),Promise.resolve().then(c.t.bind(c,14817,23))},23519:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,25227,23)),Promise.resolve().then(c.t.bind(c,86346,23)),Promise.resolve().then(c.t.bind(c,27924,23)),Promise.resolve().then(c.t.bind(c,40099,23)),Promise.resolve().then(c.t.bind(c,38243,23)),Promise.resolve().then(c.t.bind(c,28827,23)),Promise.resolve().then(c.t.bind(c,62763,23)),Promise.resolve().then(c.t.bind(c,97173,23)),Promise.resolve().then(c.bind(c,25587))},48794:(a,b,c)=>{Promise.resolve().then(c.bind(c,54677))},54677:(a,b,c)=>{"use strict";c.d(b,{SessionProvider:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call SessionProvider() from the server but SessionProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/ahmedgomaa/Downloads/pmcloude/src/app/providers/SessionProvider.tsx","SessionProvider")},57795:(a,b,c)=>{"use strict";c.d(b,{SessionProvider:()=>f});var d=c(60687),e=c(82136);function f({children:a}){return(0,d.jsx)(e.SessionProvider,{children:a})}},60367:(a,b,c)=>{"use strict";c.d(b,{A:()=>o});var d=c(60687),e=c(43210),f=c(45667),g=c(26403),h=c(89114),i=c(66524),j=c(91164),k=c(6854),l=c(81836),m=c(14689);function n({isOpen:a,onClose:b,fileId:c,fileName:f}){let[g,h]=(0,e.useState)([]),[i,j]=(0,e.useState)(""),[k,n]=(0,e.useState)("VIEW"),[o,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(!1),[s,t]=(0,e.useState)(""),u=async()=>{if(!i)return void t("Please select a user to share with");r(!0),t("");try{let a=await fetch(`/api/files/${c}/share`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sharedWith:i,permissions:k,expiresAt:o||null})});if(a.ok)t("File shared successfully!"),setTimeout(()=>{b(),t(""),j(""),n("VIEW"),p("")},1500);else{let b=await a.json();t(b.error||"Failed to share file")}}catch(a){console.error("Error sharing file:",a),t("Failed to share file")}finally{r(!1)}};return a?(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,d.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Share File"}),(0,d.jsx)("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",children:(0,d.jsx)(l.A,{className:"h-5 w-5"})})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{children:(0,d.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Sharing: ",(0,d.jsx)("span",{className:"font-medium",children:f})]})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Share with user"}),(0,d.jsxs)("select",{value:i,onChange:a=>j(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"",children:"Select a user..."}),g.map(a=>(0,d.jsxs)("option",{value:a.id,children:[a.name," (",a.email,")",a.isExternal&&" - External"]},a.id))]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permission level"}),(0,d.jsxs)("select",{value:k,onChange:a=>n(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,d.jsx)("option",{value:"VIEW",children:"View only"}),(0,d.jsx)("option",{value:"DOWNLOAD",children:"View and download"}),(0,d.jsx)("option",{value:"EDIT",children:"Full access (view, download, edit)"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expires on (optional)"}),(0,d.jsx)("input",{type:"datetime-local",value:o,onChange:a=>p(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().slice(0,16)})]}),s&&(0,d.jsxs)("div",{className:`p-3 rounded-md text-sm ${s.includes("successfully")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[s.includes("successfully")&&(0,d.jsx)(m.A,{className:"h-4 w-4 inline mr-1"}),s]}),(0,d.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,d.jsx)("button",{onClick:u,disabled:q||!i,className:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:q?"Sharing...":"Share File"}),(0,d.jsx)("button",{onClick:b,className:"flex-1 bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300",children:"Cancel"})]})]})]})}):null}function o({parentId:a,onFolderClick:b,refreshTrigger:c}){let[l,m]=(0,e.useState)([]),[o,p]=(0,e.useState)(!0),[q,r]=(0,e.useState)(null),[s,t]=(0,e.useState)(null),u=async b=>{try{let c=await fetch(`/api/files/${b}/delete`,{method:"POST"});if(c.ok){let b=a?`/api/files?parentId=${a}`:"/api/files",c=await fetch(b);if(c.ok){let a=await c.json();m(a.files||[])}r(null)}else{let a=await c.json();alert(`Error: ${a.error}`)}}catch(a){console.error("Error deleting file:",a),alert("Failed to delete file")}};return o?(0,d.jsxs)("div",{className:"p-6 text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,d.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading files..."})]}):0===l.length?(0,d.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,d.jsx)(f.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,d.jsx)("p",{children:"No files or folders yet"}),(0,d.jsx)("p",{className:"text-sm",children:"Upload some files to get started"})]}):(0,d.jsxs)(d.Fragment,{children:[s&&(0,d.jsx)(n,{isOpen:!0,onClose:()=>{t(null)},fileId:s.fileId,fileName:s.fileName}),q&&(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,d.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,d.jsxs)("div",{className:"mt-3 text-center",children:[(0,d.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:(0,d.jsx)(g.A,{className:"h-6 w-6 text-red-600"})}),(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900 mt-2",children:"Delete File"}),(0,d.jsx)("div",{className:"mt-2 px-7 py-3",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this file? This action cannot be undone."})}),(0,d.jsxs)("div",{className:"items-center px-4 py-3",children:[(0,d.jsx)("button",{onClick:()=>u(q),className:"px-4 py-2 bg-red-500 text-white text-base font-medium rounded-md w-24 mr-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-300",children:"Delete"}),(0,d.jsx)("button",{onClick:()=>{r(null)},className:"px-4 py-2 bg-gray-500 text-white text-base font-medium rounded-md w-24 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300",children:"Cancel"})]})]})})}),(0,d.jsxs)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:[(0,d.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Files & Folders"})}),(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,d.jsx)("thead",{className:"bg-gray-50",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Size"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modified"}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Owner"}),(0,d.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,d.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(a=>(0,d.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[a.isFolder?(0,d.jsx)(f.A,{className:"h-6 w-6 text-blue-500"}):(0,d.jsx)(h.A,{className:"h-6 w-6 text-gray-400"}),(0,d.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,d.jsx)("button",{onClick:()=>a.isFolder&&b?.(a.id),className:`text-sm font-medium truncate block ${a.isFolder?"text-blue-600 hover:text-blue-800 cursor-pointer hover:underline":"text-gray-900"}`,children:a.originalName}),(0,d.jsx)("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:a.mimeType})]})]})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.isFolder?(0,d.jsx)("span",{className:"text-gray-400",children:"â€”"}):(a=>{if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["Bytes","KB","MB","GB"][b]})(a.size)}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(a.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:(0,d.jsx)("span",{className:"text-xs font-medium text-blue-600",children:a.owner.name.charAt(0).toUpperCase()})}),(0,d.jsx)("span",{className:"truncate",children:a.owner.name})]})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,d.jsxs)("div",{className:"flex justify-end space-x-1",children:[!a.isFolder&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:()=>{var b;return b=a.id,void window.open(`/api/files/${b}/view`,"_blank")},className:"inline-flex items-center p-1.5 border border-transparent rounded-md text-gray-400 hover:text-blue-600 hover:bg-blue-50 transition-colors",title:"View file",children:(0,d.jsx)(i.A,{className:"h-4 w-4"})}),(0,d.jsx)("button",{onClick:()=>((a,b)=>{let c=document.createElement("a");c.href=`/api/files/${a}/download`,c.download=b,document.body.appendChild(c),c.click(),document.body.removeChild(c)})(a.id,a.originalName),className:"inline-flex items-center p-1.5 border border-transparent rounded-md text-gray-400 hover:text-green-600 hover:bg-green-50 transition-colors",title:"Download file",children:(0,d.jsx)(j.A,{className:"h-4 w-4"})})]}),(0,d.jsx)("button",{onClick:()=>{t({fileId:a.id,fileName:a.originalName})},className:"inline-flex items-center p-1.5 border border-transparent rounded-md text-gray-400 hover:text-purple-600 hover:bg-purple-50 transition-colors",title:"Share",children:(0,d.jsx)(k.A,{className:"h-4 w-4"})}),(0,d.jsx)("button",{onClick:()=>{r(a.id)},className:"inline-flex items-center p-1.5 border border-transparent rounded-md text-gray-400 hover:text-red-600 hover:bg-red-50 transition-colors",title:"Delete",children:(0,d.jsx)(g.A,{className:"h-4 w-4"})})]})})]},a.id))})]})})]})]})}},61135:()=>{},83849:(a,b,c)=>{"use strict";c.d(b,{A:()=>h});var d=c(60687),e=c(43210),f=c(51934),g=c(89944);function h({parentId:a,onUploadSuccess:b}){let[c,h]=(0,e.useState)(!1),[i,j]=(0,e.useState)({}),k=(0,e.useCallback)(async c=>{for(let b of(h(!0),c)){let c=new FormData;c.append("file",b),a&&c.append("parentId",a);try{j(a=>({...a,[b.name]:0})),(await fetch("/api/files/upload",{method:"POST",body:c})).ok?(j(a=>({...a,[b.name]:100})),setTimeout(()=>{j(a=>{let c={...a};return delete c[b.name],c})},2e3)):console.error("Upload failed for",b.name)}catch(a){console.error("Upload error:",a)}}h(!1),b?.()},[a,b]),{getRootProps:l,getInputProps:m,isDragActive:n}=(0,f.VB)({onDrop:k,multiple:!0,maxSize:0x6400000});return(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{...l(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${n?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[(0,d.jsx)("input",{...m()}),(0,d.jsx)(g.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n?(0,d.jsx)("p",{className:"text-blue-600",children:"Drop the files here..."}):(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-gray-600 mb-2",children:"Drag & drop files here, or click to select files"}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Maximum file size: 100MB"})]})]}),Object.keys(i).length>0&&(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("h4",{className:"font-medium text-gray-900",children:"Uploading Files"}),Object.entries(i).map(([a,b])=>(0,d.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,d.jsx)("span",{className:"truncate",children:a}),(0,d.jsxs)("span",{children:[b,"%"]})]}),(0,d.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,d.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${b}%`}})})]},a))]})]})}},88962:(a,b,c)=>{Promise.resolve().then(c.bind(c,57795))},94431:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>g,metadata:()=>f});var d=c(37413),e=c(54677);c(61135);let f={title:"PMS Cloud - Cloud Storage System",description:"Secure cloud storage and file sharing for your business"};function g({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsx)("body",{children:(0,d.jsx)(e.SessionProvider,{children:a})})})}},99154:(a,b,c)=>{"use strict";c.d(b,{A:()=>t});var d=c(60687),e=c(82136),f=c(85814),g=c.n(f),h=c(30474),i=c(16189),j=c(20816),k=c(45667),l=c(6854),m=c(93635),n=c(45994),o=c(14566),p=c(10435),q=c(89944),r=c(48544),s=c(34944);function t(){let{data:a}=(0,e.useSession)(),b=(0,i.usePathname)(),c=a?.user?.role==="SUPER_ADMIN"||a?.user?.role==="ADMIN",f=[{name:"Dashboard",href:"/dashboard",icon:j.A},{name:"My Files",href:"/dashboard/files",icon:k.A},{name:"Shared with Me",href:"/dashboard/shared",icon:l.A}],t=[{name:"User Management",href:"/admin/users",icon:m.A},{name:"System Analytics",href:"/admin/analytics",icon:n.A},{name:"Settings",href:"/admin/settings",icon:o.A}],u=[{name:"Create Folder",icon:p.A,action:"create-folder"},{name:"Upload Files",icon:q.A,action:"upload-files"},{name:"Share Folder",icon:l.A,action:"share-folder"}],v=a=>b===a||b.startsWith(a+"/");return(0,d.jsxs)("div",{className:"flex flex-col w-64 bg-gray-900 text-white min-h-screen",children:[(0,d.jsx)("div",{className:"flex items-center h-16 px-6 bg-gray-800",children:(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsxs)("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center",children:[(0,d.jsx)(h.default,{src:"/logo.svg",alt:"Company Logo",width:24,height:24,className:"w-6 h-6",onError:a=>{a.currentTarget.style.display="none"}}),(0,d.jsx)(r.A,{className:"h-6 w-6 text-blue-600 hidden"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-white text-lg font-bold",children:"PMS Cloud"}),(0,d.jsx)("p",{className:"text-gray-300 text-xs",children:"File Management"})]})]})}),a?.user&&(0,d.jsx)("div",{className:"px-6 py-4 bg-gray-800 border-b border-gray-700",children:(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:(0,d.jsx)("span",{className:"text-white font-medium text-sm",children:a.user.name?.charAt(0).toUpperCase()})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"text-white text-sm font-medium truncate",children:a.user.name}),(0,d.jsx)("p",{className:"text-gray-300 text-xs truncate",children:a.user.email}),(0,d.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 mt-1",children:a.user.role})]})]})}),(0,d.jsxs)("div",{className:"px-6 py-4 border-b border-gray-700",children:[(0,d.jsx)("h3",{className:"text-gray-300 text-xs font-semibold uppercase tracking-wider mb-3",children:"Quick Actions"}),(0,d.jsx)("div",{className:"space-y-2",children:u.map(a=>(0,d.jsxs)("button",{onClick:()=>(a=>{switch(a){case"create-folder":window.location.href="/dashboard/files?action=create-folder";break;case"upload-files":window.location.href="/dashboard/files?action=upload";break;case"share-folder":window.location.href="/dashboard/files?action=share"}})(a.action),className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-300 rounded-lg hover:bg-gray-800 hover:text-white transition-colors group",children:[(0,d.jsx)(a.icon,{className:"mr-3 h-4 w-4 text-gray-400 group-hover:text-white"}),a.name]},a.action))})]}),(0,d.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[(0,d.jsxs)("nav",{className:"flex-1 px-6 space-y-1",children:[f.map(a=>(0,d.jsxs)(g(),{href:a.href,className:`group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${v(a.href)?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:[(0,d.jsx)(a.icon,{className:`mr-3 h-5 w-5 ${v(a.href)?"text-white":"text-gray-400 group-hover:text-white"}`}),a.name]},a.name)),c&&(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"border-t border-gray-700 mt-6 pt-6",children:[(0,d.jsx)("h3",{className:"px-3 text-xs font-semibold text-gray-300 uppercase tracking-wider mb-3",children:"Administration"}),(0,d.jsx)("div",{className:"space-y-1",children:t.map(a=>(0,d.jsxs)(g(),{href:a.href,className:`group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${v(a.href)?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"}`,children:[(0,d.jsx)(a.icon,{className:`mr-3 h-5 w-5 ${v(a.href)?"text-white":"text-gray-400 group-hover:text-white"}`}),a.name]},a.name))})]})})]}),(0,d.jsx)("div",{className:"flex-shrink-0 px-6 py-4 border-t border-gray-700",children:(0,d.jsxs)("button",{onClick:async()=>{try{await (0,e.signOut)({callbackUrl:"/auth/signin",redirect:!0})}catch(a){console.error("Logout error:",a),window.location.href="/auth/signin"}},className:"w-full group flex items-center px-3 py-2 text-sm font-medium text-gray-300 rounded-lg hover:bg-red-600 hover:text-white transition-colors",children:[(0,d.jsx)(s.A,{className:"mr-3 h-5 w-5 text-gray-400 group-hover:text-white"}),"Sign Out"]})})]})]})}}};